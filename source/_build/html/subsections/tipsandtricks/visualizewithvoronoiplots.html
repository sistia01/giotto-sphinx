

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Visualize Spatial Data with Voronoi Plots &mdash; Giotto 1.0 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="prev" title="Adding and Working with Images in Giotto: How to Work with Background Images?" href="workingwithimages.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> Giotto
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../general.html">General Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general.html#references">References</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../general.html#other-relevant-information">Other Relevant Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html#description">Description</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html#requirements">Requirements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html#installation">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html#workflow-diagram">Workflow Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html#howtos">HowTos</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gettingstarted.html#giotto-workflow-analyses"><span class="xref std std-doc">Giotto Workflow Analyses</span></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html">Giotto Workflow Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#giotto-workflow-analyses">Giotto Workflow Analyses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#create-a-giotto-object">1. Create a Giotto Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#process-and-filter-a-giotto-object">2. Process and Filter a Giotto Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#dimension-reduction">3. Dimension Reduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#cluster-cells-or-spots">4. Cluster cells or spots</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#identify-differentially-expressed-genes">5. Identify differentially expressed genes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#annotate-clusters">6. Annotate clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#cell-type-enrichment-or-deconvolution-per-spot">7. Cell-type enrichment or deconvolution per spot</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#create-a-spatial-grid-or-network">8. Create a Spatial grid or Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#find-genes-with-a-spatially-coherent-gene-expression-pattern">9. Find genes with a spatially coherent gene expression pattern</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#spatially-coexpressed-genes">10. Identify genes that are spatially co-expressed</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#explore-spatial-domains-with-hmrf">11. Explore spatial domains with HMRF</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#calculate-spatial-cell-cell-interaction-enrichment">12. Calculate spatial cell-cell interaction enrichment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#find-cell-cell-interaction-changed-genes-icg">13. Find cell-cell interaction changed genes (ICG)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#enriched-or-depleted-ligand-receptor-interactions">14. Identify enriched or depleted ligand-receptor interactions in hetero and homo-typic cell interactions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../giottoworkflowanalyses.html#export-giotto-results-to-use-in-giotto-viewer">15. Export Giotto results to use in Giotto viewer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../datasets.html">Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../errorsfaqsandtips.html">FAQs and Solutions to Errors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../errorsfaqsandtips.html#errors-on-macos">Errors on MacOS</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../errorsfaqsandtips.html#errors-on-windows">Errors on Windows</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../additionalinformation.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../additionalinformation.html#contact">Contact</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../additionalinformation.html#contribute">Contribute</a></li>
<li class="toctree-l1"><a class="reference internal" href="giottoclass.html">Working with the Giotto class: <em>How to create Giotto object with precomputed results?</em></a></li>
<li class="toctree-l1"><a class="reference internal" href="giottoclass.html#the-giotto-class">1. The Giotto Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="giottoclass.html#giotto-slots">2. Giotto Slots</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html">How to Subset a Giotto Object?</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html#the-visium-10x-whole-brain">1. The Visium 10X Whole Brain</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html#show-only-a-subset-of-clusters">2. Show only a subset of clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html#show-only-a-subset-of-the-clusters-excluding-not-selected-cells">3. Show only a subset of the clusters, excluding not selected cells</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html#create-spatial-plots-grouped-by-the-leiden-clustering-result">4. Create spatial plots grouped by the leiden clustering result</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html#create-dimension-plots-grouped-by-the-hmrf-result">5. Create dimension plots grouped by the HMRF result</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html#create-a-new-giotto-object-by-subsetting-selected-clusters">6. Create a new Giotto object by subsetting selected clusters</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtosubsetgiottoobject.html#create-a-new-giotto-object-by-subsetting-based-on-spatial-coordinates-locations">7. Create a new Giotto object by subsetting based on spatial coordinates/locations</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtovisualizeandsaveplots.html">How to Visualize and Save Plots in Giotto?</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtovisualizeandsaveplots.html#create-giotto-instructions-and-giotto-object">1. Create Giotto instructions and Giotto object</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtovisualizeandsaveplots.html#create-giotto-object">2. Create Giotto Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtovisualizeandsaveplots.html#working-with-giotto-instructions">3. Working with Giotto Instructions</a></li>
<li class="toctree-l1"><a class="reference internal" href="howtovisualizeandsaveplots.html#different-ways-of-saving-a-plot">4. Different Ways of Saving a Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="testandstoremultipleanayses.html">How to Test and Store Multiple Parameters or Analyses?</a></li>
<li class="toctree-l1"><a class="reference internal" href="testandstoremultipleanayses.html#calculate-highly-variable-genes-in-two-different-manners">1. Calculate highly variable genes in two different manners</a></li>
<li class="toctree-l1"><a class="reference internal" href="testandstoremultipleanayses.html#perform-multiple-pcas">2. Perform Multiple PCAs</a></li>
<li class="toctree-l1"><a class="reference internal" href="testandstoremultipleanayses.html#create-multiple-umaps">3. Create Multiple UMAPs</a></li>
<li class="toctree-l1"><a class="reference internal" href="testandstoremultipleanayses.html#create-multiple-spatial-networks">4. Create Multiple Spatial Networks</a></li>
<li class="toctree-l1"><a class="reference internal" href="testandstoremultipleanayses.html#find-spatial-genes-in-multiple-ways">5. Find Spatial Genes in Multiple Ways</a></li>
<li class="toctree-l1"><a class="reference internal" href="waystovisualizespatialdata.html">Different ways to visualize your spatial data?</a></li>
<li class="toctree-l1"><a class="reference internal" href="waystovisualizespatialdata.html#functions-specific-to-a-task-or-analysis">1. Functions specific to a task or analysis:</a></li>
<li class="toctree-l1"><a class="reference internal" href="waystovisualizespatialdata.html#functions-that-use-the-spatial-coordinates-of-each-cell-or-spot-they-usually-start-with-spatxxx">2. Functions that use the spatial coordinates of each cell or spot, they usually start with spatXXX</a></li>
<li class="toctree-l1"><a class="reference internal" href="waystovisualizespatialdata.html#functions-that-use-the-dimension-reduction-coordinates-of-each-cell-or-spot-they-usually-start-with-dimxxx">3. Functions that use the dimension reduction coordinates of each cell or spot, they usually start with dimXXX</a></li>
<li class="toctree-l1"><a class="reference internal" href="waystovisualizespatialdata.html#functions-for-co-visualization-that-combine-spat-2-and-dim-3">4. Functions for co-visualization that combine spat (2) and dim (3)</a></li>
<li class="toctree-l1"><a class="reference internal" href="waystovisualizespatialdata.html#both-in-2d-and-3d">5. Both in 2D and 3D</a></li>
<li class="toctree-l1"><a class="reference internal" href="waystovisualizespatialdata.html#ways-to-save-plots">6. Ways to Save Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="workingwithimages.html">Adding and Working with Images in Giotto: How to Work with Background Images?</a></li>
<li class="toctree-l1"><a class="reference internal" href="workingwithimages.html#create-giotto-object">1. Create Giotto Object</a></li>
<li class="toctree-l1"><a class="reference internal" href="workingwithimages.html#align-plot">2. Align Plot</a></li>
<li class="toctree-l1"><a class="reference internal" href="workingwithimages.html#change-background-of-a-giotto-or-magick-image">3. Change Background of a Giotto or Magick Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="workingwithimages.html#add-image-from-scratch">4. Add Image From Scratch</a></li>
<li class="toctree-l1"><a class="reference internal" href="workingwithimages.html#example-kidney-analysis">5. Example Kidney Analysis</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Visualize Spatial Data with Voronoi Plots</a></li>
<li class="toctree-l1"><a class="reference internal" href="#start-with-the-analysis-of-the-mini-seqfish-dataset">1. Start with the analysis of the mini seqFISH+ dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="#voronoi-plot-examples">2. Voronoi Plot Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="#creating-neighbors-and-showing-neighbors">3. Creating Neighbors and Showing Neighbors</a></li>
<li class="toctree-l1"><a class="reference internal" href="#gene-expression-and-voronoi-plots">4. Gene Expression and Voronoi Plots</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Giotto</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Visualize Spatial Data with Voronoi Plots</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/subsections/tipsandtricks/visualizewithvoronoiplots.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="visualize-spatial-data-with-voronoi-plots">
<span id="voronoi-plots"></span><h1>Visualize Spatial Data with Voronoi Plots<a class="headerlink" href="#visualize-spatial-data-with-voronoi-plots" title="Permalink to this headline">¶</a></h1>
<p>Voronoi plots are an attractive way to visualize spatial expression data since it reduces whitespace between single cells or spots, however the voronoi borders do NOT necessarily mimick the true cell borders. Nevertheless it has been used to ‘segment’ cells and assign transcripts to individual cells. Here we merely use it as a beautifull visualization alternative to simple ‘points’.</p>
</div>
<div class="section" id="start-with-the-analysis-of-the-mini-seqfish-dataset">
<h1>1. Start with the analysis of the mini seqFISH+ dataset<a class="headerlink" href="#start-with-the-analysis-of-the-mini-seqfish-dataset" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><p>This dataset is part of the Giotto package</p></li>
<li><p>It is very small and easy to run</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>library(Giotto)

# input data
VC_exprs_small = read.table(system.file(&quot;extdata&quot;, &quot;seqfish_field_expr.txt&quot;, package = &#39;Giotto&#39;))
VC_locs_small = read.table(system.file(&quot;extdata&quot;, &quot;seqfish_field_locs.txt&quot;, package = &#39;Giotto&#39;))

# giotto object
VC_small &lt;- createGiottoObject(raw_exprs = VC_exprs_small, spatial_locs = VC_locs_small)
VC_small &lt;- filterGiotto(gobject = VC_small, expression_threshold = 0.5, gene_det_in_min_cells = 0, min_det_genes_per_cell = 0)
VC_small &lt;- normalizeGiotto(gobject = VC_small, scalefactor = 6000, verbose = T)
VC_small &lt;- addStatistics(gobject = VC_small)

# clustering
VC_small &lt;- calculateHVG(gobject = VC_small)
gene_metadata = fDataDT(VC_small)
featgenes = gene_metadata[hvg == &#39;yes&#39; &amp; perc_cells &gt; 4 &amp; mean_expr_det &gt; 0.5]$gene_ID
VC_small &lt;- runPCA(gobject = VC_small, genes_to_use = featgenes, scale_unit = F)
VC_small &lt;- runUMAP(VC_small, dimensions_to_use = 1:5, n_threads = 2)
VC_small &lt;- createNearestNetwork(gobject = VC_small, dimensions_to_use = 1:5, k = 5)
VC_small &lt;- doLeidenCluster(gobject = VC_small, resolution = 0.4, n_iterations = 1000)

# spatial grid and network
VC_small = createSpatialNetwork(gobject = VC_small, minimum_k = 2)
VC_small = createSpatialGrid(gobject = VC_small, sdimx_stepsize = 500, sdimy_stepsize = 500)
</pre></div>
</div>
</div>
<div class="section" id="voronoi-plot-examples">
<h1>2. Voronoi Plot Examples<a class="headerlink" href="#voronoi-plot-examples" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># spatial voronoi plot with selected clusters</span>
<span class="n">spatPlot</span><span class="p">(</span><span class="n">VC_small</span><span class="p">,</span> <span class="n">point_shape</span> <span class="o">=</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">,</span> <span class="n">cell_color</span> <span class="o">=</span><span class="s1">&#39;leiden_clus&#39;</span><span class="p">,</span> <span class="n">select_cell_groups</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/1_voronoi.png"><img alt="voronoi plots" src="../../_images/1_voronoi.png" style="width: 400px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># spatial voronoi plot without showing not selected clusters</span>
<span class="n">spatPlot</span><span class="p">(</span><span class="n">VC_small</span><span class="p">,</span> <span class="n">point_shape</span> <span class="o">=</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">,</span> <span class="n">cell_color</span> <span class="o">=</span><span class="s1">&#39;leiden_clus&#39;</span><span class="p">,</span> <span class="n">select_cell_groups</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">show_other_cells</span> <span class="o">=</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/2_voronoi_no_others.png"><img alt="voronoi plots" src="../../_images/2_voronoi_no_others.png" style="width: 400px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># spatial voronoi plot without showing not selected cells, but showing the voronoi borders</span>
<span class="n">spatPlot</span><span class="p">(</span><span class="n">VC_small</span><span class="p">,</span> <span class="n">point_shape</span> <span class="o">=</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">,</span> <span class="n">cell_color</span> <span class="o">=</span><span class="s1">&#39;leiden_clus&#39;</span><span class="p">,</span> <span class="n">select_cell_groups</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">show_other_cells</span> <span class="o">=</span> <span class="n">F</span><span class="p">,</span> <span class="n">vor_border_color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/3_voronoi_no_others_black_border.png"><img alt="voronoi plots" src="../../_images/3_voronoi_no_others_black_border.png" style="width: 400px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># visualization of both dimension reduction and spatial results</span>
<span class="n">spatDimPlot</span><span class="p">(</span><span class="n">gobject</span> <span class="o">=</span> <span class="n">VC_small</span><span class="p">,</span> <span class="n">cell_color</span> <span class="o">=</span> <span class="s1">&#39;leiden_clus&#39;</span><span class="p">,</span> <span class="n">spat_point_shape</span> <span class="o">=</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">,</span> <span class="n">dim_point_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/4_voronoi_spat_dim.png"><img alt="voronoi plots" src="../../_images/4_voronoi_spat_dim.png" style="width: 400px;" /></a>
</div>
<div class="section" id="creating-neighbors-and-showing-neighbors">
<h1>3. Creating Neighbors and Showing Neighbors<a class="headerlink" href="#creating-neighbors-and-showing-neighbors" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">nb_annot</span> <span class="o">=</span> <span class="n">findNetworkNeighbors</span><span class="p">(</span><span class="n">VC_small</span><span class="p">,</span>
                            <span class="n">spatial_network_name</span> <span class="o">=</span> <span class="s1">&#39;Delaunay_network&#39;</span><span class="p">,</span>
                            <span class="n">source_cell_ids</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;cell_1&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_6&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_10&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_91&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_92&#39;</span><span class="p">,</span> <span class="s1">&#39;cell_93&#39;</span><span class="p">))</span>
<span class="n">VC_small</span> <span class="o">=</span> <span class="n">addCellMetadata</span><span class="p">(</span><span class="n">VC_small</span><span class="p">,</span> <span class="n">new_metadata</span> <span class="o">=</span> <span class="n">nb_annot</span><span class="p">,</span> <span class="n">by_column</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="n">column_cell_ID</span> <span class="o">=</span> <span class="s1">&#39;cell_ID&#39;</span><span class="p">)</span>

<span class="n">spatPlot</span><span class="p">(</span><span class="n">VC_small</span><span class="p">,</span> <span class="n">point_shape</span> <span class="o">=</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">,</span> <span class="n">cell_color</span> <span class="o">=</span><span class="s1">&#39;nb_cells&#39;</span><span class="p">,</span>
         <span class="n">cell_color_code</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="n">source</span> <span class="o">=</span> <span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">target</span> <span class="o">=</span> <span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">both</span> <span class="o">=</span> <span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">others</span> <span class="o">=</span> <span class="s1">&#39;lightgrey&#39;</span><span class="p">))</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/5_voronoi_neighbors.png"><img alt="voronoi plots" src="../../_images/5_voronoi_neighbors.png" style="width: 400px;" /></a>
</div>
<div class="section" id="gene-expression-and-voronoi-plots">
<h1>4. Gene Expression and Voronoi Plots<a class="headerlink" href="#gene-expression-and-voronoi-plots" title="Permalink to this headline">¶</a></h1>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1">## overlay gene expression information ##</span>
 <span class="n">selected_genes</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;Cldn5&#39;</span><span class="p">,</span> <span class="s1">&#39;Soga3&#39;</span><span class="p">)</span>

 <span class="c1"># selected genes original</span>
 <span class="n">spatGenePlot</span><span class="p">(</span><span class="n">gobject</span> <span class="o">=</span> <span class="n">VC_small</span><span class="p">,</span> <span class="n">expression_values</span> <span class="o">=</span> <span class="s1">&#39;scaled&#39;</span><span class="p">,</span> <span class="n">genes</span> <span class="o">=</span> <span class="n">selected_genes</span><span class="p">,</span> <span class="n">point_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/6_original_points.png"><img alt="voronoi plots" src="../../_images/6_original_points.png" style="width: 400px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># selected genes voronoi</span>
<span class="n">spatGenePlot</span><span class="p">(</span><span class="n">gobject</span> <span class="o">=</span> <span class="n">VC_small</span><span class="p">,</span> <span class="n">genes</span> <span class="o">=</span> <span class="n">selected_genes</span><span class="p">,</span> <span class="n">point_shape</span> <span class="o">=</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">,</span>
             <span class="n">expression_values</span> <span class="o">=</span> <span class="s1">&#39;scaled&#39;</span><span class="p">,</span> <span class="n">vor_border_color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/7_voronoi_genes.png"><img alt="voronoi plots" src="../../_images/7_voronoi_genes.png" style="width: 400px;" /></a>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># one gene + black background and white borders</span>
<span class="n">spatGenePlot</span><span class="p">(</span><span class="n">gobject</span> <span class="o">=</span> <span class="n">VC_small</span><span class="p">,</span> <span class="n">genes</span> <span class="o">=</span> <span class="s1">&#39;Cldn5&#39;</span><span class="p">,</span> <span class="n">point_size</span> <span class="o">=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">point_shape</span> <span class="o">=</span> <span class="s1">&#39;voronoi&#39;</span><span class="p">,</span>
             <span class="n">expression_values</span> <span class="o">=</span> <span class="s1">&#39;scaled&#39;</span><span class="p">,</span> <span class="n">vor_border_color</span> <span class="o">=</span> <span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">show_network</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="n">network_color</span> <span class="o">=</span> <span class="s1">&#39;green&#39;</span><span class="p">,</span>
             <span class="n">background_color</span> <span class="o">=</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">cell_color_gradient</span> <span class="o">=</span> <span class="n">c</span><span class="p">(</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="s1">&#39;red&#39;</span><span class="p">),</span> <span class="n">gradient_midpoint</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">cow_n_col</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../../_images/8_voronoi_gene_black_bg.png"><img alt="voronoi plots" src="../../_images/8_voronoi_gene_black_bg.png" style="width: 400px;" /></a>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="workingwithimages.html" class="btn btn-neutral float-left" title="Adding and Working with Images in Giotto: How to Work with Background Images?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Ruben Dries, Qian Zhu, Huipeng Li, Rui Dong, Guo-Cheng Yuan.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>